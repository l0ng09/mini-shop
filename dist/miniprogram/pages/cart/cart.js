(()=>{var t=getApp(),i=null;Page({data:{billList:[],buyNumMin:1,buyNumMax:5,saveHidden:!0,totalPrice:0,selectedList:[]},onLoad:function(){i=this},onShow:function(){wx.showNavigationBarLoading(),t.getShopCart({success:function(t){i.setData({billList:t}),wx.hideNavigationBarLoading()}})},deleteSelected:function(){var i=this,a=this.data.billList.filter((function(t){return!i.data.selectedList.includes(t._id)})),e=this;t.delShopCart({list:e.data.selectedList,success:function(){e.setData({billList:a,selectedList:[]})}})},updateBillList:function(){var t=this;this.data.billList.forEach((function(i){t.data.selectedList.includes(i._id)?i.active=!0:i.active=!1})),this.setData({billList:this.data.billList})},updateTotalPrice:function(){var t=this,i=0;this.data.billList.forEach((function(a){t.data.selectedList.includes(a._id)&&(i+=Number(a.price)*Number(a.number))})),this.setData({totalPrice:i})},onAllSelect:function(){var t=this,i=[];this.data.selectedList.length===this.data.billList.length||(i=this.data.billList.map((function(t){return t._id}))),this.setData({selectedList:i},(function(){t.updateBillList(),t.updateTotalPrice()}))},selectTap:function(t){var i=this;console.log(t);var a=t.currentTarget.dataset.id;if(this.data.selectedList.includes(a)){var e=this.data.selectedList.indexOf(a);this.data.selectedList.splice(e,1)}else this.data.selectedList.push(a);this.setData({selectedList:this.data.selectedList},(function(){i.updateBillList(),i.updateTotalPrice()}))},minusBtnTap:function(t){var i=this,a=t.currentTarget.dataset.id;this.data.billList.forEach((function(t){t._id===a&&t.number>i.data.buyNumMin&&t.number--})),this.setData({billList:this.data.billList})},addBtnTap:function(t){var i=this,a=t.currentTarget.dataset.id;this.data.billList.forEach((function(t){t._id===a&&t.number<i.data.buyNumMax&&t.number++})),this.setData({billList:this.data.billList})},editTap:function(){this.setData({saveHidden:!1})},saveTap:function(){this.setData({saveHidden:!0})},toPayOrder:function(){wx.setStorageSync("ids",this.data.selectedList),wx.navigateTo({url:"/pages/submit/submit"})}})})();