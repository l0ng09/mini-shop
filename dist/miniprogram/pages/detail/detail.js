(()=>{var t=getApp(),i=null;Page({data:{autoplay:!0,interval:5e3,duration:1e3,loading:!0,detail:{},buyNumMin:1,buyNumMax:5,billNum:0,bill:{number:1},shopType:"",hideShopPopup:!0,imgheight:0},onLoad:function(a){i=this,console.log(a),t.getGoodSDetail({id:a.id,success:function(t){i.setData({loading:!1,detail:t})}})},goShopCart:function(){wx.switchTab({url:"/pages/cart/cart"})},addShopCart:function(){null!=this.data.bill.options&&Object.keys(this.data.bill.options).length==this.data.detail.options.length?(this.renderBillOptionToList(),t.addShopCart({data:Object.assign({},this.data.bill,{commodityId:this.data.detail._id}),cart:!0,success:function(){i.closePopupTap()},fail:function(){wx.showModal({title:"抱歉",content:"购物车加入失败，请稍后再试",showCancel:!1})}})):wx.showToast({title:"请选择类型",icon:"none"})},buyNow:function(){Object.keys(this.data.bill.options).length==this.data.detail.options.length?(this.renderBillOptionToList(),t.addShopCart({data:Object.assign({},this.data.bill,{commodityId:this.data.detail._id}),cart:!1,success:function(){i.closePopupTap(),wx.navigateTo({url:"../submit/submit"})},fail:function(){wx.showModal({title:"抱歉",content:"购物车加入失败，请稍后再试",showCancel:!1})}})):wx.showToast({title:"请选择类型",icon:"none"})},toAddShopCart:function(){this.setData({shopType:"addShopCart",hideShopPopup:!1})},toBuy:function(){this.setData({shopType:"buy",hideShopPopup:!1})},closePopupTap:function(){this.setData({hideShopPopup:!0,"bill.options":{}})},labelItemTap:function(t){var i=t.currentTarget.dataset||{},a=Object.assign({},this.data.bill.options);a[i.key]=i.idx,this.setData({"bill.options":a})},numMinusTap:function(){this.data.bill.number>this.data.buyNumMin&&this.setData({"bill.number":--this.data.bill.number})},numAddTap:function(){this.data.bill.number<this.data.buyNumMax&&this.setData({"bill.number":++this.data.bill.number})},renderBillOptionToList:function(){var t=[],i=this.data.bill.options;this.data.detail.options.forEach((function(a){t.push({name:a.name,value:a.value[i[a.key]]})})),this.setData({"bill.options":t})},imgload:function(t){var i=t.detail.height/t.detail.width*750;this.setData({imgheight:i})}})})();